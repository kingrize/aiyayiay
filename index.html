<!doctype html>
<html lang="id">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Jiya: happy birthday sayang.</title>

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Nunito:wght@500;700;800&family=Short+Stack&display=swap"
            rel="stylesheet"
        />

        <link
            rel="preload"
            as="audio"
            href="https://raw.githubusercontent.com/kingrize/aiyayiay/main/song/wildflower.mp3"
            crossorigin="anonymous"
        />

        <link
            rel="preload"
            as="image"
            href="https://ik.imagekit.io/notargazyu/aiyaeyeglass.jpg"
            crossorigin="anonymous"
        />

        <style>
            :root {
                --bg1: #fff7f0;
                --bg2: #f6fbff;
                --ink: #2c2a2a;
                --muted: #6b6460;
                --paper: #fffdf9;
                --edge: #eadfda;
                --stamp: #ffb3c7;
                --accent: #ff6fa3;
                --shadow: 0 18px 45px rgba(30, 20, 10, 0.1);
            }
            * {
                box-sizing: border-box;
            }
            body {
                margin: 0;
                min-height: 100svh;
                font-family:
                    "Nunito",
                    system-ui,
                    -apple-system,
                    Segoe UI,
                    Roboto,
                    Arial,
                    sans-serif;
                color: var(--ink);
                background:
                    radial-gradient(
                        900px 500px at 20% 10%,
                        var(--bg2),
                        transparent 60%
                    ),
                    radial-gradient(
                        900px 500px at 80% 20%,
                        #fff2f7,
                        transparent 55%
                    ),
                    radial-gradient(
                        900px 500px at 50% 90%,
                        #fffbe9,
                        transparent 60%
                    ),
                    linear-gradient(180deg, var(--bg1), #fff);
                display: grid;
                place-items: center;
                padding: 24px;
            }
            .wrap {
                width: min(900px, 100%);
            }

            .envelope {
                position: relative;
                border-radius: 22px;
                background: linear-gradient(180deg, #fff, #fffaf3);
                box-shadow: var(--shadow);
                border: 1px solid rgba(0, 0, 0, 0.06);
                overflow: hidden;
                padding: 18px;
            }
            .envelope::before {
                content: "";
                position: absolute;
                inset: -2px;
                background: repeating-linear-gradient(
                    45deg,
                    rgba(255, 111, 163, 0.1) 0 10px,
                    rgba(255, 216, 168, 0.1) 10px 20px,
                    rgba(173, 216, 230, 0.1) 20px 30px
                );
                opacity: 0.55;
                pointer-events: none;
            }

            .doodle {
                position: absolute;
                inset: 12px;
                border-radius: 18px;
                pointer-events: none;
            }
            .doodle svg {
                width: 100%;
                height: 100%;
            }
            .doodle path {
                fill: none;
                stroke: rgba(255, 111, 163, 0.45);
                stroke-width: 3.2;
                stroke-linecap: round;
                stroke-linejoin: round;
                stroke-dasharray: 1 10;
                filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.06));
            }

            .seal {
                position: absolute;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                width: 110px;
                height: 110px;
                border-radius: 28px;
                background: radial-gradient(
                    circle at 30% 30%,
                    #fff,
                    var(--stamp)
                );
                border: 1px solid rgba(0, 0, 0, 0.1);
                box-shadow:
                    0 18px 40px rgba(0, 0, 0, 0.12),
                    0 0 0 14px rgba(255, 111, 163, 0.1);
                display: grid;
                place-items: center;
                font-size: 44px;
                cursor: pointer;
                user-select: none;
                z-index: 5;
                animation: sealPulse 1.7s ease-in-out infinite;
            }
            .seal:active {
                transform: translate(-50%, -50%) scale(0.98);
            }
            @keyframes sealPulse {
                0%,
                100% {
                    filter: none;
                }
                50% {
                    filter: brightness(1.04);
                }
            }
            .is-open .seal {
                display: none;
            }

            .floaties {
                position: absolute;
                inset: 0;
                pointer-events: none;
                overflow: hidden;
                z-index: 1;
            }
            .floaties span {
                position: absolute;
                font-size: 18px;
                opacity: 0.6;
                animation: drift 10s linear infinite;
                filter: drop-shadow(0 6px 8px rgba(0, 0, 0, 0.08));
            }
            @keyframes drift {
                from {
                    transform: translateY(40px) translateX(0) rotate(0deg);
                }
                to {
                    transform: translateY(-900px) translateX(40px) rotate(18deg);
                }
            }

            .letter {
                position: relative;
                margin: 6px;
                padding: 22px 22px 18px;
                background: var(--paper);
                border: 1px solid var(--edge);
                border-radius: 18px;
                overflow: hidden;
                transform: translateY(26px);
                opacity: 0;
                transition:
                    transform 0.75s cubic-bezier(0.2, 0.9, 0.2, 1),
                    opacity 0.75s cubic-bezier(0.2, 0.9, 0.2, 1);
                box-shadow: 0 10px 28px rgba(0, 0, 0, 0.08);
                z-index: 2;
            }
            .is-open .letter {
                transform: translateY(0px);
                opacity: 1;
            }

            .letter::before {
                content: "";
                position: absolute;
                inset: 0;
                background:
                    linear-gradient(
                        transparent 24px,
                        rgba(0, 0, 0, 0.035) 25px
                    ),
                    linear-gradient(
                        90deg,
                        transparent 18px,
                        rgba(255, 111, 163, 0.2) 18px 20px,
                        transparent 20px
                    ),
                    repeating-linear-gradient(
                        0deg,
                        rgba(0, 0, 0, 0.015) 0 2px,
                        transparent 2px 6px
                    );
                background-size:
                    100% 26px,
                    100% 100%,
                    100% 100%;
                opacity: 0.65;
                pointer-events: none;
                mix-blend-mode: multiply;
            }
            .crayon-scribble {
                position: absolute;
                right: -40px;
                top: -40px;
                width: 180px;
                height: 180px;
                background: radial-gradient(
                    circle at 40% 40%,
                    rgba(255, 216, 168, 0.65),
                    rgba(255, 111, 163, 0.2) 55%,
                    transparent 70%
                );
                transform: rotate(12deg);
                opacity: 0.85;
                pointer-events: none;
            }

            .header {
                display: flex;
                align-items: flex-start;
                justify-content: space-between;
                gap: 14px;
                position: relative;
                z-index: 3;
            }
            h1 {
                margin: 0;
                font-family: "Short Stack", "Nunito", system-ui, sans-serif;
                font-size: clamp(22px, 3.2vw, 34px);
                line-height: 1.2;
            }
            .meta {
                font-size: 13px;
                color: var(--muted);
                text-align: right;
                white-space: nowrap;
                font-family: "Short Stack", "Nunito", system-ui, sans-serif;
            }

            .mini-stamp {
                width: 64px;
                height: 64px;
                border-radius: 16px;
                background: radial-gradient(
                    circle at 30% 30%,
                    #fff,
                    var(--stamp)
                );
                border: 1px solid rgba(0, 0, 0, 0.1);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
                display: grid;
                place-items: center;
                flex: 0 0 auto;
                user-select: none;
                overflow: hidden;
                position: relative;
                transform: rotate(8deg);
            }
            .mini-stamp img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transform: rotate(-8deg) scale(1.04);
                filter: saturate(1.02) contrast(1.02);
            }
            .mini-stamp::after {
                content: "";
                position: absolute;
                inset: 0;
                background: radial-gradient(
                    circle at 30% 25%,
                    rgba(255, 255, 255, 0.85),
                    transparent 55%
                );
                opacity: 0.45;
                pointer-events: none;
            }

            .body {
                position: relative;
                z-index: 3;
                margin-top: 14px;
                color: #2f2c2b;
                font-size: 16px;
                line-height: 1.85;
                min-height: 360px;
            }
            .typed-viewport {
                position: relative;
                max-height: 360px;
                overflow: auto;
                padding-right: 6px;
                scroll-behavior: smooth;
            }
            .typed-viewport::-webkit-scrollbar {
                width: 10px;
            }
            .typed-viewport::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.1);
                border-radius: 999px;
                border: 3px solid rgba(255, 255, 255, 0.9);
            }

            .highlight {
                display: inline-block;
                padding: 2px 8px;
                border-radius: 999px;
                background: rgba(255, 111, 163, 0.14);
                border: 1px solid rgba(255, 111, 163, 0.18);
                font-family: "Short Stack", "Nunito", system-ui, sans-serif;
            }
            .divider {
                margin: 14px 0;
                height: 1px;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(0, 0, 0, 0.12),
                    transparent
                );
                border: 0;
            }

            .footer {
                position: relative;
                z-index: 3;
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 12px;
                margin-top: 10px;
                flex-wrap: wrap;
            }
            .sign {
                font-weight: 800;
                font-family: "Short Stack", "Nunito", system-ui, sans-serif;
            }
            .btns {
                display: none;
                gap: 10px;
                flex-wrap: wrap;
            }
            .is-open .btns {
                display: flex;
            }

            button {
                border: 1px solid rgba(0, 0, 0, 0.12);
                background: #fff;
                padding: 10px 12px;
                border-radius: 14px;
                cursor: pointer;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
                font-weight: 800;
                font-family: "Nunito", system-ui, sans-serif;
            }
            button:active {
                transform: translateY(1px);
            }
            .primary {
                background: linear-gradient(180deg, #ff8bb6, #ff6fa3);
                color: white;
                border: 1px solid rgba(0, 0, 0, 0.1);
            }

            [data-type] {
                visibility: hidden;
                opacity: 0;
            }
            .typed-ready[data-type] {
                visibility: visible;
                opacity: 1;
            }

            .typefade {
                position: relative;
            }
            .typefade .sentence {
                display: inline;
                opacity: 0;
                transform: translateY(6px);
                transition:
                    opacity 0.85s ease,
                    transform 0.85s ease;
                will-change: opacity, transform;
            }
            .typefade .sentence.show {
                opacity: 1;
                transform: translateY(0);
            }

            .caret {
                display: inline-block;
                width: 2px;
                height: 1em;
                margin-left: 6px;
                background: rgba(44, 42, 42, 0.7);
                border-radius: 2px;
                transform: translateY(2px);
                animation: caretBlink 1.05s steps(1, end) infinite;
            }
            @keyframes caretBlink {
                50% {
                    opacity: 0;
                }
            }

            .footer-sign {
                position: relative;
                opacity: 0;
                transform: translateY(14px);
                transition:
                    opacity 0.7s ease,
                    transform 0.7s cubic-bezier(0.2, 0.9, 0.2, 1);
            }
            .footer-sign.show {
                opacity: 1;
                transform: translateY(0);
            }
            .footer-sign::before {
                content: "";
                position: absolute;
                left: -10px;
                right: -10px;
                top: -6px;
                bottom: -6px;
                border-radius: 14px;
                background:
                    radial-gradient(
                        120px 46px at 18% 55%,
                        rgba(30, 20, 10, 0.16),
                        transparent 62%
                    ),
                    radial-gradient(
                        90px 40px at 60% 40%,
                        rgba(30, 20, 10, 0.12),
                        transparent 68%
                    ),
                    radial-gradient(
                        140px 52px at 86% 65%,
                        rgba(30, 20, 10, 0.1),
                        transparent 70%
                    );
                opacity: 0;
                transform: scale(0.92);
                filter: blur(6px);
                transition:
                    opacity 0.9s ease,
                    transform 0.9s ease,
                    filter 0.9s ease;
                pointer-events: none;
                mix-blend-mode: multiply;
            }
            .footer-sign.show::before {
                opacity: 1;
                transform: scale(1);
                filter: blur(2px);
            }
        </style>

        <script
            src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
    </head>

    <body>
        <div class="wrap" id="captureRoot">
            <div class="envelope" id="envelope">
                <div class="floaties" id="floaties" aria-hidden="true"></div>

                <div class="doodle" aria-hidden="true">
                    <svg viewBox="0 0 100 100" preserveAspectRatio="none">
                        <path
                            d="M6,10 C18,3 30,6 44,8 C60,10 74,4 92,10
                   C97,18 95,32 94,48 C93,64 98,76 92,90
                   C76,96 62,92 48,93 C34,94 22,98 8,92
                   C3,78 6,66 6,52 C6,36 2,22 6,10Z"
                        />
                    </svg>
                </div>

                <div
                    class="seal"
                    id="sealOpen"
                    role="button"
                    aria-label="Buka surat"
                    tabindex="0"
                >
                    üß∏
                </div>

                <div class="letter" id="letter" aria-live="polite">
                    <div class="crayon-scribble" aria-hidden="true"></div>

                    <div class="header">
                        <div>
                            <h1>
                                Selamat Ulang Tahun,
                                <span class="highlight" id="panggilan"
                                    >sayang</span
                                >
                            </h1>
                            <div class="meta">
                                <div id="tanggal"></div>
                                <div>Dari: <b id="fromName">aku</b></div>
                            </div>
                        </div>

                        <div class="mini-stamp" title="stempel imut">
                            <img
                                id="stampPhoto"
                                src="https://ik.imagekit.io/notargazyu/aiyaeyeglass.jpg"
                                alt="Aiya"
                                loading="eager"
                                decoding="async"
                                crossorigin="anonymous"
                            />
                        </div>
                    </div>

                    <div class="body">
                        <div class="typed-viewport" id="typedViewport">
                            <p data-type>Hai sayang ü§ç</p>
                            <p data-type>Jiya a.k.a your boyfriend here!</p>
                            <p data-type>
                                Selamat ulangtahun ya sayang! ummm... thank you
                                for staying:D There were days that felt heavy,
                                days when you had to be strong even when you
                                didn‚Äôt feel okay at all. And honestly, I just
                                want you to know that I see you.
                            </p>
                            <hr class="divider" data-type />
                            <p data-type>
                                You don‚Äôt always have to be strong, sayang. I
                                might not be able to fix everything, but I want
                                to be your safe place. The place where you can
                                rest, where you don‚Äôt have to pretend, where you
                                can just be‚Ä¶ you.
                            </p>
                            <p data-type>
                                On your birthday, I don‚Äôt wish for you to become
                                someone else. I just hope you‚Äôll be a little
                                kinder to yourself. Because you deserve
                                happiness. You deserve peace. And you deserve
                                love exactly as you are sayangku&lt;3!
                            </p>
                            <p data-type>
                                Thank you for holding on, Aiya. I‚Äôm really proud
                                of you. And I love you, more than I could ever
                                put into words sayang!
                            </p>
                            <p data-type style="margin-top: 16px">
                                P.S. If one day you forget how strong and
                                precious you are, pleaseee remember‚Ä¶ you have
                                meeee. Always. Happy birthday, my love!
                            </p>
                        </div>
                    </div>

                    <div class="footer" id="letterFooter">
                        <div class="footer-sign" id="footerSign">
                            Your boyfriend,<br />
                            <span class="sign" id="ttd">‚Äî Jiya</span>
                        </div>

                        <div class="btns">
                            <button id="btnClose" class="primary">Tutup</button>
                            <button id="btnCrayon">üç∞ Gift</button>
                            <button id="btnShot">üì∏</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <audio
            id="bgm"
            preload="auto"
            crossorigin="anonymous"
            src="https://raw.githubusercontent.com/kingrize/aiyayiay/main/song/wildflower.mp3"
        ></audio>

        <script>
            const herName = "Aiya";
            const myName = "Jiya";
            const callHer = "sayang";

            const envelope = document.getElementById("envelope");
            const floaties = document.getElementById("floaties");
            const panggilan = document.getElementById("panggilan");
            const fromName = document.getElementById("fromName");
            const ttd = document.getElementById("ttd");
            const typedViewport = document.getElementById("typedViewport");
            const sealOpen = document.getElementById("sealOpen");
            const footerSign = document.getElementById("footerSign");
            const captureRoot = document.getElementById("captureRoot");
            const btnShot = document.getElementById("btnShot");

            const bgm = document.getElementById("bgm");
            bgm.loop = true;
            bgm.volume = 0.55;
            try {
                bgm.load();
            } catch (e) {}

            panggilan.textContent = callHer;
            fromName.textContent = myName;
            ttd.textContent = "‚Äî " + myName;

            const now = new Date();
            const opts = {
                weekday: "long",
                year: "numeric",
                month: "long",
                day: "numeric",
            };
            document.getElementById("tanggal").textContent =
                now.toLocaleDateString("id-ID", opts);

            envelope.classList.remove("is-open");

            function sprinkleCute(count = 10, mode = "cute") {
                const cute = ["üíó", "‚ú®", "üéÄ", "üß∏", "üå∑", "üç™", "‚òÅÔ∏è", "üíï"];
                const crayon = ["üñçÔ∏è", "‚úèÔ∏è", "‚≠ê", "üß°", "üíõ", "üíô", "üíö", "üíú"];
                const icons = mode === "crayon" ? crayon : cute;

                for (let i = 0; i < count; i++) {
                    const s = document.createElement("span");
                    s.textContent =
                        icons[Math.floor(Math.random() * icons.length)];
                    s.style.left = Math.random() * 100 + "%";
                    s.style.bottom = -20 - Math.random() * 80 + "px";
                    s.style.animationDuration = 7 + Math.random() * 6 + "s";
                    s.style.fontSize = 14 + Math.random() * 14 + "px";
                    s.style.opacity = 0.35 + Math.random() * 0.55;
                    floaties.appendChild(s);
                    setTimeout(() => s.remove(), 12000);
                }
            }

            const typedEls = Array.from(
                document.querySelectorAll("[data-type]"),
            );
            const original = new Map();
            typedEls.forEach((el) => original.set(el, el.innerHTML));

            function splitIntoSentences(text) {
                const t = (text || "")
                    .replace(/\s+/g, " ")
                    .replace(/\s([,.!?‚Ä¶:;])/g, "$1")
                    .trim();
                if (!t) return [];
                const matches = t.match(/[^.!?‚Ä¶]+[.!?‚Ä¶]+|[^.!?‚Ä¶]+$/g);
                return (matches || []).map((s) => s.trim()).filter(Boolean);
            }

            function enhanceInlineHTML(sentence) {
                return sentence
                    .replace(
                        /\bsayang\b/gi,
                        `<span class="highlight">${callHer}</span>`,
                    )
                    .replace(/\bAiya\b/g, `<b>${herName}</b>`);
            }

            function prepareForTyping() {
                typedViewport.scrollTop = 0;
                footerSign.classList.remove("show");

                typedEls.forEach((el) => {
                    el.classList.add("typed-ready");
                    el.classList.remove("typefade");

                    if (el.tagName === "HR") {
                        el.style.opacity = "0";
                        el.style.transition = "opacity .35s ease";
                    } else {
                        el.innerHTML = "";
                    }
                });
            }

            function textFromHTML(html) {
                const tmp = document.createElement("div");
                tmp.innerHTML = html;
                return (tmp.textContent || "").trim();
            }

            async function playTypeFade() {
                const sentenceDelay = 1020;
                const elementDelay = 580;
                const hrDelay = 380;
                const openLeadDelay = 240;

                await new Promise((r) => setTimeout(r, openLeadDelay));

                for (const el of typedEls) {
                    if (el.tagName === "HR") {
                        el.classList.add("typefade");
                        el.style.opacity = "1";
                        await new Promise((r) => setTimeout(r, hrDelay));
                        continue;
                    }

                    const raw = textFromHTML(original.get(el) || "");
                    const sentences = splitIntoSentences(raw);

                    el.classList.add("typefade");
                    el.innerHTML = sentences
                        .map(
                            (s) =>
                                `<span class="sentence">${enhanceInlineHTML(s)} </span>`,
                        )
                        .join("");

                    const caret = document.createElement("span");
                    caret.className = "caret";
                    caret.setAttribute("aria-hidden", "true");
                    el.appendChild(caret);

                    const spans = Array.from(el.querySelectorAll(".sentence"));
                    for (const s of spans) {
                        s.classList.add("show");
                        typedViewport.scrollTo({
                            top: typedViewport.scrollHeight,
                            behavior: "smooth",
                        });
                        await new Promise((r) => setTimeout(r, sentenceDelay));
                    }

                    caret.style.opacity = "0";
                    caret.style.transition = "opacity .25s ease";
                    await new Promise((r) => setTimeout(r, 160));
                    caret.remove();

                    await new Promise((r) => setTimeout(r, elementDelay));
                }

                await new Promise((r) => setTimeout(r, 650));
                footerSign.classList.add("show");
            }

            function resetToHidden() {
                typedViewport.scrollTop = 0;
                footerSign.classList.remove("show");

                typedEls.forEach((el) => {
                    el.classList.remove("typed-ready");
                    el.classList.remove("typefade");

                    if (el.tagName === "HR") {
                        el.style.opacity = "";
                        el.style.transition = "";
                    } else {
                        el.innerHTML = original.get(el);
                    }
                });
            }

            async function startMusicOnGesture() {
                try {
                    if (bgm.paused) {
                        bgm.muted = false;
                        bgm.currentTime = 0;
                        await bgm.play();
                    }
                } catch (e) {}
            }

            let isPlaying = false;

            async function openLetter() {
                if (isPlaying || envelope.classList.contains("is-open")) return;
                isPlaying = true;

                await startMusicOnGesture();

                envelope.classList.add("is-open");
                sprinkleCute(10, "cute");

                prepareForTyping();
                await playTypeFade();

                isPlaying = false;
            }

            function closeLetter() {
                envelope.classList.remove("is-open");
                floaties.innerHTML = "";
                isPlaying = false;
                resetToHidden();
            }

            async function takeScreenshot() {
                if (!window.html2canvas) return;

                const oldText = btnShot.textContent;
                btnShot.disabled = true;
                btnShot.textContent = "‚è≥";

                try {
                    if (document.fonts && document.fonts.ready) {
                        await document.fonts.ready;
                    }

                    const prevScroll = { x: window.scrollX, y: window.scrollY };
                    window.scrollTo(0, 0);
                    await new Promise((r) => setTimeout(r, 120));

                    const canvas = await html2canvas(document.body, {
                        useCORS: true,
                        allowTaint: false,
                        backgroundColor: null,
                        scale: Math.max(
                            2,
                            Math.floor(window.devicePixelRatio || 1),
                        ),
                        windowWidth: document.documentElement.scrollWidth,
                        windowHeight: document.documentElement.scrollHeight,
                        scrollX: 0,
                        scrollY: 0,
                    });

                    window.scrollTo(prevScroll.x, prevScroll.y);

                    const dataUrl = canvas.toDataURL("image/png", 1.0);
                    const a = document.createElement("a");
                    const ts = new Date();
                    const pad = (n) => String(n).padStart(2, "0");
                    const name = `jiya-letter-${ts.getFullYear()}-${pad(ts.getMonth() + 1)}-${pad(ts.getDate())}_${pad(ts.getHours())}${pad(ts.getMinutes())}.png`;
                    a.href = dataUrl;
                    a.download = name;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                } catch (e) {
                } finally {
                    btnShot.disabled = false;
                    btnShot.textContent = oldText;
                }
            }

            sealOpen.addEventListener("click", openLetter);
            sealOpen.addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === " ") {
                    e.preventDefault();
                    openLetter();
                }
            });

            document
                .getElementById("btnClose")
                .addEventListener("click", closeLetter);
            btnShot.addEventListener("click", takeScreenshot);

            const crayonLines = [
                "I love youuuuu üß°",
                "Meow",
                "kamu sangat cantik <3",
                "mwahhh ~ ",
                "sayangkuuuuuu üòΩ",
                "aiyakuu <3",
                "aku sayang kamuuuuu",
                "i  l o v e  y o u",
            ];

            document
                .getElementById("btnCrayon")
                .addEventListener("click", async () => {
                    if (!envelope.classList.contains("is-open"))
                        await openLetter();
                    sprinkleCute(18, "crayon");

                    const note = document.createElement("div");
                    note.textContent =
                        crayonLines[
                            Math.floor(Math.random() * crayonLines.length)
                        ];
                    note.style.position = "absolute";
                    note.style.right = "18px";
                    note.style.bottom = "92px";
                    note.style.maxWidth = "220px";
                    note.style.padding = "10px 12px";
                    note.style.borderRadius = "14px";
                    note.style.background = "rgba(255,255,255,.85)";
                    note.style.border = "2px dashed rgba(255,111,163,.35)";
                    note.style.boxShadow = "0 12px 24px rgba(0,0,0,.08)";
                    note.style.fontFamily =
                        '"Short Stack","Nunito",system-ui,sans-serif';
                    note.style.transform = `rotate(${(-6 + Math.random() * 12).toFixed(1)}deg)`;
                    note.style.zIndex = "4";
                    note.style.color = "#3b3330";

                    const old = document.getElementById("crayonNote");
                    if (old) old.remove();
                    note.id = "crayonNote";

                    document.getElementById("letter").appendChild(note);

                    setTimeout(() => {
                        note.style.opacity = "0";
                        note.style.transition = "opacity .6s";
                    }, 5200);
                    setTimeout(() => {
                        note.remove();
                    }, 6000);
                });
        </script>
    </body>
</html>
